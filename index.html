<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CL-PLO | Continual Learning x Portfolio Optimization</title>
    <link rel="stylesheet" href="./coreline.css" />
  </head>
  <body>
    <header class="hero">
      <div class="shell">
        <p class="eyebrow">Continual Learning x Portfolio Optimization</p>
        <h1>A principled bridge: memory-safe model updates as risk control for live portfolios</h1>
        <p class="lead">
          The core question is operational, not academic: <strong>how do we adapt to drift without deleting stress
          memory</strong>? This page unifies continual-learning constraints and portfolio decision controls in one
          deployable mechanism.
        </p>
        <div class="hero-actions">
          <a class="btn btn-primary" href="#bridge">See The Bridge</a>
          <a class="btn btn-ghost" href="#atlas">Compare Strategies</a>
          <a class="btn btn-ghost" href="#validation">Run Validation</a>
        </div>
        <div class="hero-signal">
          <article>
            <h3>Decision scope</h3>
            <p>Only the adapter update law changes.</p>
          </article>
          <article>
            <h3>System constant</h3>
            <p>Same optimizer, same constraints, same stream.</p>
          </article>
          <article>
            <h3>Deployment objective</h3>
            <p>Retain stress behavior while fitting new drift.</p>
          </article>
        </div>
      </div>
    </header>

    <main class="shell">
      <section id="bridge" class="section">
        <h2>1. The Missing Bridge</h2>
        <p class="section-intro">
          Portfolio teams already constrain turnover and exposure to control harmful moves. Continual learning needs the
          same discipline in parameter space: control harmful update directions while preserving useful adaptation.
        </p>

        <div class="bridge-frame">
          <article class="bridge-side">
            <h3>Continual learning side</h3>
            <p>Unconstrained drift gradients can overwrite stress memory.</p>
            <p class="bridge-note">Failure mode: catastrophic forgetting after long drift runs.</p>
          </article>

          <article class="bridge-core">
            <h3>Shared principle</h3>
            <p>Constrain damaging motion, preserve productive motion.</p>
            <p class="math-block">
              \[
              \text{minimize adaptation loss}
              \quad\text{s.t.}\quad
              \text{interference budget} \le \varepsilon
              \]
            </p>
          </article>

          <article class="bridge-side">
            <h3>Portfolio control side</h3>
            <p>Unconstrained weight shifts create cost and drawdown instability.</p>
            <p class="bridge-note">Failure mode: paper alpha erased by implementation friction.</p>
          </article>
        </div>

        <div class="bridge-equations">
          <article class="eq-card">
            <h3>Update constraint (learning layer)</h3>
            <p class="math-block">
              \[
              \tilde{\mathbf{g}}=
              \arg\min_{\mathbf{g}}\lVert\mathbf{g}-\mathbf{g}_{\mathrm{d}}\rVert_2^2
              \;\text{s.t.}\;
              \langle\mathbf{g},\mathbf{g}_{\mathrm{a}}\rangle\ge-\varepsilon
              \]
            </p>
          </article>
          <article class="eq-card">
            <h3>Weight constraint (decision layer)</h3>
            <p class="math-block">
              \[
              \mathbf{w}_t^\star=
              \arg\min_{\mathbf{w}\in\mathcal{W}}
              \left(-\hat{\mu}_t^\top\mathbf{w}
              +\frac{\gamma}{2}\mathbf{w}^\top\hat{\Sigma}_t\mathbf{w}
              +\lambda_{\mathrm{tc}}\lVert\mathbf{w}-\mathbf{w}_{t-1}\rVert_1\right)
              \]
            </p>
          </article>
        </div>

        <p class="refs">
          References:
          <a href="https://openreview.net/forum?id=Hkf2_sC5FX" target="_blank" rel="noreferrer">A-GEM</a>,
          <a href="https://arxiv.org/abs/2405.13383" target="_blank" rel="noreferrer">projection in continual PEFT</a>,
          <a href="https://web.stanford.edu/~boyd/papers/pdf/cvx_portfolio.pdf" target="_blank" rel="noreferrer">multi-period portfolio control</a>,
          <a href="https://dl.acm.org/doi/10.1145/2638548" target="_blank" rel="noreferrer">online portfolio selection</a>.
        </p>
      </section>

      <section id="objects" class="section">
        <h2>2. One-to-One Mapping (CL â†” Portfolio)</h2>
        <p class="section-intro">
          This is the spine of the post. Each continual-learning object has a direct portfolio-control counterpart and
          an implementation handle.
        </p>

        <article class="mapping-wrap">
          <table class="mapping-table">
            <thead>
              <tr>
                <th>Continual learning object</th>
                <th>Portfolio counterpart</th>
                <th>Implementation handle</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>\(\mathcal{D}^{\mathrm{drift}}_t\): non-stationary stream</td>
                <td>Current regime flow</td>
                <td>rolling drift minibatches</td>
              </tr>
              <tr>
                <td>\(\mathcal{D}^{\mathrm{anchor}}_t\): memory buffer</td>
                <td>Stress scenario library</td>
                <td>tagged crisis slices + pinned replay set</td>
              </tr>
              <tr>
                <td>\(\langle\mathbf{g},\mathbf{g}_{\mathrm{a}}\rangle\ge-\varepsilon\): stability cone</td>
                <td>risk budget inequality</td>
                <td>interference threshold \(\varepsilon\)</td>
              </tr>
              <tr>
                <td>\(\theta_t\): adapter state</td>
                <td>decision engine state</td>
                <td>LoRA adapter parameters only</td>
              </tr>
              <tr>
                <td>\((\hat{\mu}_t,\hat{\Sigma}_t)\)</td>
                <td>alpha + risk forecasts</td>
                <td>fixed forecast-to-optimizer interface</td>
              </tr>
              <tr>
                <td>\(\mathbf{w}_t^\star\)</td>
                <td>tradable portfolio</td>
                <td>turnover-penalized convex solve</td>
              </tr>
            </tbody>
          </table>
        </article>
      </section>

      <section id="stack" class="section">
        <h2>3. Shared Deployment Stack (Constant Across Methods)</h2>
        <p class="section-intro">All strategies run through the same infrastructure. Only the adapter update rule changes.</p>

        <figure class="stack-figure" aria-label="Shared CL-PLO system pipeline">
          <div class="stack-node">Input stream<br /><span>market + macro + text</span></div>
          <div class="stack-arrow">&rarr;</div>
          <div class="stack-node frozen">Frozen backbone \(\phi\)</div>
          <div class="stack-arrow">&rarr;</div>
          <div class="stack-node updated">Adapter \(\theta_t\)<br /><span>method-specific update</span></div>
          <div class="stack-arrow">&rarr;</div>
          <div class="stack-node">Forecasts \((\hat{\mu}_t,\hat{\Sigma}_t)\)</div>
          <div class="stack-arrow">&rarr;</div>
          <div class="stack-node">Optimizer \(\rightarrow \mathbf{w}_t^\star\)</div>
        </figure>
      </section>

      <section id="mechanism" class="section">
        <h2>4. Anchor Memory and Projection Mechanism</h2>
        <p class="section-intro">This is the critical mechanism: where retention is enforced and where adaptation is allowed.</p>

        <div class="mechanism-grid">
          <article class="mech-card">
            <h3>Anchor memory construction</h3>
            <table class="anchor-table">
              <thead>
                <tr>
                  <th>Regime tag</th>
                  <th>Memory slice</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Credit shock</td>
                  <td>spread widening + funding stress factors</td>
                </tr>
                <tr>
                  <td>Liquidity break</td>
                  <td>limit-down tape + microstructure stress</td>
                </tr>
                <tr>
                  <td>Inflation surprise</td>
                  <td>macro release text + factor regime reversal</td>
                </tr>
              </tbody>
            </table>
          </article>

          <article class="mech-card">
            <h3>Projection geometry</h3>
            <p class="math-block">
              \[
              \tilde{\mathbf{g}}=\Pi_{\mathcal{C}_\varepsilon}(\mathbf{g}_{\mathrm{d}}),
              \quad
              \mathcal{C}_\varepsilon=\{\mathbf{g}:\langle\mathbf{g},\mathbf{g}_{\mathrm{a}}\rangle\ge-\varepsilon\}
              \]
            </p>
            <figure class="projection-figure" aria-label="Gradient projection in feasible cone">
              <svg viewBox="0 0 320 170" role="img">
                <line x1="36" y1="138" x2="294" y2="138" stroke="#a7a7a7" stroke-width="1.5"></line>
                <line x1="36" y1="138" x2="36" y2="26" stroke="#a7a7a7" stroke-width="1.5"></line>
                <line x1="36" y1="138" x2="220" y2="52" stroke="#777" stroke-width="2" stroke-dasharray="7 6"></line>
                <line x1="36" y1="138" x2="188" y2="78" stroke="#111" stroke-width="2.8"></line>
                <line x1="188" y1="78" x2="220" y2="52" stroke="#b8b8b8" stroke-width="1.5"></line>
                <line x1="108" y1="24" x2="256" y2="24" stroke="#b2b2b2" stroke-width="1.3"></line>
                <text x="228" y="49" font-size="11" fill="#3b3b3b">drift g_d</text>
                <text x="194" y="76" font-size="11" fill="#111">projected g~</text>
                <text x="110" y="18" font-size="10" fill="#4e4e4e">feasible boundary (anchor-safe)</text>
              </svg>
            </figure>
          </article>

          <article class="mech-card">
            <h3>Operational consequence</h3>
            <ul>
              <li>What moves: adapter update direction in PEFT space.</li>
              <li>What is preserved: first-order anchor alignment budget.</li>
              <li>What stays fixed: optimizer objective and risk controls.</li>
            </ul>
            <p class="mech-note">Result: drift adaptation with explicit memory safety, not implicit hope.</p>
          </article>
        </div>
      </section>

      <section id="atlas" class="section">
        <h2>5. Strategy Atlas (Competing Decision Systems)</h2>
        <p class="section-intro">Same pipeline interface, different control law. Read left to right and compare what each method protects.</p>

        <div class="pipeline-legend">
          <span class="legend-item frozen">frozen</span>
          <span class="legend-item memory">memory store</span>
          <span class="legend-item constraint">constraint operator</span>
          <span class="legend-item updated">updated parameter</span>
        </div>

        <article class="strategy-card">
          <header class="strategy-head">
            <p class="method-tag">Established baseline</p>
            <h3>Strategy A: Naive continual update</h3>
            <p>Protects adaptation speed; sacrifices explicit retention control.</p>
          </header>
          <div class="pipeline-grid">
            <div class="col-head">Input</div>
            <div class="col-head">Memory</div>
            <div class="col-head">Constraint</div>
            <div class="col-head">Update law</div>
            <div class="col-head">Portfolio output</div>

            <div class="cell">\(\mathcal{D}^{\mathrm{drift}}_t\)</div>
            <div class="cell">none</div>
            <div class="cell">none</div>
            <div class="cell updated">\(\theta_{t+1}=\theta_t-\eta\mathbf{g}_{\mathrm{d}}\)</div>
            <div class="cell">\((\hat{\mu}_t,\hat{\Sigma}_t)\rightarrow\mathbf{w}_t^\star\)</div>
          </div>
          <div class="strategy-math">
            <p class="math-block">
              \[
              \mathbf{g}_{\mathrm{d}}=\nabla_\theta\mathcal{L}_{\mathrm{drift}},
              \qquad
              \theta_{t+1}=\theta_t-\eta\mathbf{g}_{\mathrm{d}}
              \]
            </p>
          </div>
        </article>

        <article class="strategy-card">
          <header class="strategy-head">
            <p class="method-tag">Established baseline</p>
            <h3>Strategy B: Anchor-regularized update</h3>
            <p>Protects retention softly through replay weighting; trades off with slower drift fit.</p>
          </header>
          <div class="pipeline-grid">
            <div class="col-head">Input</div>
            <div class="col-head">Memory</div>
            <div class="col-head">Constraint</div>
            <div class="col-head">Update law</div>
            <div class="col-head">Portfolio output</div>

            <div class="cell">\(\mathcal{D}^{\mathrm{drift}}_t\)</div>
            <div class="cell memory">\(\mathcal{D}^{\mathrm{anchor}}_t\)</div>
            <div class="cell">soft via \(\beta\)</div>
            <div class="cell updated">\(\theta_{t+1}=\theta_t-\eta\nabla_\theta(\mathcal{L}_{\mathrm{d}}+\beta\mathcal{L}_{\mathrm{a}})\)</div>
            <div class="cell">\((\hat{\mu}_t,\hat{\Sigma}_t)\rightarrow\mathbf{w}_t^\star\)</div>
          </div>
          <div class="strategy-math">
            <p class="math-block">
              \[
              \min_\theta\;\mathcal{L}_{\mathrm{drift}}(\theta)+\beta\mathcal{L}_{\mathrm{anchor}}(\theta)
              \]
            </p>
          </div>
        </article>

        <article class="strategy-card">
          <header class="strategy-head">
            <p class="method-tag proposed">Proposed in this work</p>
            <h3>Strategy C: Anchor + projection</h3>
            <p>Protects stress memory explicitly with geometric interference control.</p>
          </header>
          <div class="pipeline-grid">
            <div class="col-head">Input</div>
            <div class="col-head">Memory</div>
            <div class="col-head">Constraint</div>
            <div class="col-head">Update law</div>
            <div class="col-head">Portfolio output</div>

            <div class="cell">\(\mathcal{D}^{\mathrm{drift}}_t\)</div>
            <div class="cell memory">\(\mathcal{D}^{\mathrm{anchor}}_t\)</div>
            <div class="cell constraint">\(\mathbf{g}_{\mathrm{d}}\to\tilde{\mathbf{g}}\) under anchor-safe cone</div>
            <div class="cell updated">\(\theta_{t+1}=\theta_t-\eta(\tilde{\mathbf{g}}+\beta\mathbf{g}_{\mathrm{a}})\)</div>
            <div class="cell">\((\hat{\mu}_t,\hat{\Sigma}_t)\rightarrow\mathbf{w}_t^\star\)</div>
          </div>
          <div class="strategy-math">
            <p class="math-block">
              \[
              \tilde{\mathbf{g}}=
              \arg\min_{\mathbf{g}}\lVert\mathbf{g}-\mathbf{g}_{\mathrm{d}}\rVert_2^2
              \;\text{s.t.}\;
              \langle\mathbf{g},\mathbf{g}_{\mathrm{a}}\rangle\ge-\varepsilon
              \]
            </p>
          </div>
        </article>
      </section>

      <section id="decision" class="section">
        <h2>6. Deployment Decision Surface</h2>
        <p class="section-intro">Read this before looking at run outputs. It states the expected ordering of outcomes.</p>

        <div class="decision-grid">
          <article class="decision-surface" aria-label="Adaptation-retention tradeoff map">
            <h3>Adaptation vs retention map</h3>
            <svg viewBox="0 0 360 230" role="img">
              <line x1="48" y1="184" x2="330" y2="184" stroke="#b5b5b5" stroke-width="1.5"></line>
              <line x1="48" y1="184" x2="48" y2="30" stroke="#b5b5b5" stroke-width="1.5"></line>
              <text x="176" y="214" font-size="11" fill="#444">drift adaptation quality</text>
              <text x="12" y="114" transform="rotate(-90, 12, 114)" font-size="11" fill="#444">stress retention quality</text>

              <circle cx="116" cy="82" r="7" fill="#6e6e6e"></circle>
              <text x="126" y="85" font-size="11" fill="#333">naive</text>

              <circle cx="190" cy="116" r="7" fill="#0f5fbf"></circle>
              <text x="200" y="119" font-size="11" fill="#0f5fbf">anchor</text>

              <circle cx="264" cy="148" r="7" fill="#111"></circle>
              <text x="274" y="151" font-size="11" fill="#111">anchor + projection</text>
            </svg>
          </article>

          <article class="decision-rules">
            <h3>Expected ordering (before experiment)</h3>
            <ul>
              <li>Stress MSE: projection < anchor < naive.</li>
              <li>Drift MSE: naive <= anchor <= projection.</li>
              <li>Drawdown resilience: projection should dominate naive in stress-heavy runs.</li>
              <li>Promotion criterion: ordering must hold across repeated seeds and stress presets.</li>
            </ul>
          </article>
        </div>
      </section>

      <section id="implementation" class="section">
        <h2>7. What To Implement Next</h2>
        <p class="section-intro">A direct build sequence from this page to a production pilot.</p>

        <div class="implementation-grid">
          <article>
            <h3>Step 1: Build anchor memory</h3>
            <ul>
              <li>Define regime tags.</li>
              <li>Assemble pinned stress slices.</li>
              <li>Freeze this set for all method comparisons.</li>
            </ul>
          </article>
          <article>
            <h3>Step 2: Add projection gate</h3>
            <ul>
              <li>Compute \(\mathbf{g}_{\mathrm{d}},\mathbf{g}_{\mathrm{a}}\) each step.</li>
              <li>Project drift gradients into anchor-safe cone.</li>
              <li>Log distortion and interference-rate diagnostics.</li>
            </ul>
          </article>
          <article>
            <h3>Step 3: Decide promotion</h3>
            <ul>
              <li>Run repeated stress-heavy seeds.</li>
              <li>Check ordering in stress MSE, drift MSE, drawdown.</li>
              <li>Promote only if ordering remains stable.</li>
            </ul>
          </article>
        </div>
      </section>

      <section id="validation" class="section" aria-label="Validation">
        <h2>8. Validation Run (Evidence Layer)</h2>
        <p class="section-intro">Now test whether the empirical run matches the mechanism-level expectations.</p>
        <article id="expectation-check" class="expectation-check"></article>

        <div class="control-stack">
          <div class="preset-row">
            <button id="apply-quick" class="btn btn-ghost" type="button">Quick</button>
            <button id="apply-proposal" class="btn btn-ghost" type="button">Default</button>
            <button id="apply-stress" class="btn btn-ghost" type="button">Stress+</button>
          </div>

          <form id="config-form" class="knob-grid">
            <label>Update steps<input name="steps" type="number" step="1" /></label>
            <label>Anchor weight<input name="anchorBeta" type="number" step="0.01" /></label>
            <label>Stress frequency<input name="pStress" type="number" step="0.01" /></label>
            <label>LoRA rank<input name="loraRank" type="number" step="1" /></label>
            <label>Seed<input name="seed" type="number" step="1" /></label>
          </form>

          <div class="action-row">
            <button id="run-demo" class="btn btn-primary" type="button">Run validation</button>
            <button id="reset-form" class="btn btn-ghost" type="button">Reset</button>
            <button id="export-run" class="btn btn-ghost" type="button">Export JSON</button>
          </div>
        </div>

        <div class="run-status">
          <p id="status-line">Ready.</p>
          <div class="progress-track"><div id="progress-fill"></div></div>
        </div>

        <article id="decision-card" class="decision-card"></article>
        <div id="impact-kpis" class="kpi-row"></div>

        <div class="chart-grid">
          <article>
            <h3>Impact vs naive</h3>
            <canvas id="impact-chart" class="chart-canvas"></canvas>
          </article>
          <article>
            <h3>Equity curves</h3>
            <canvas id="equity-chart" class="chart-canvas"></canvas>
          </article>
        </div>

        <article class="table-wrap">
          <h3>Method scoreboard</h3>
          <table id="method-table" class="method-table"></table>
        </article>

        <article id="takeaway" class="takeaway"></article>
      </section>
    </main>

    <script>
      window.MathJax = {
        tex: {
          inlineMath: [["\\(", "\\)"]],
          displayMath: [["\\[", "\\]"]],
        },
        svg: {
          fontCache: "global",
        },
      };
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <script type="module" src="./src/main.js"></script>
  </body>
</html>
