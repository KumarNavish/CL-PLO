<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CL-PLO | Constraint-Aligned PEFT Decision Artifact</title>
    <link rel="stylesheet" href="./coreline.css" />
  </head>
  <body>
    <header class="hero">
      <div class="shell">
        <nav class="topbar">
          <a class="toplink" href="./strategy-comparison.html">Strategy Comparison</a>
          <span class="version">Coreline V3 · CL-PLO only</span>
        </nav>

        <p class="eyebrow">Continual Learning for Portfolio Optimization</p>
        <h1>Constrained PEFT protects stress behavior while adapting to drift.</h1>
        <p class="lead">
          This page exists for one decision: should anchor-plus-projection be promoted over naive online updates for a
          pilot portfolio stack.
        </p>

        <div class="hero-actions">
          <button id="hero-run" class="btn btn-primary">Run Core Test</button>
          <a class="btn btn-ghost" href="#demo">Open Live Evaluation</a>
          <a class="btn btn-ghost" href="#appendix">Open Technical Backbone</a>
        </div>
      </div>
    </header>

    <main class="shell">
      <section class="card thesis" aria-label="Core thesis">
        <h2>Core Thesis</h2>
        <p>
          Use naive updates as the speed baseline, anchor regularization as retention support, and projection as the
          hard guardrail against catastrophic stress forgetting.
        </p>
        <ul>
          <li><strong>Protect:</strong> stress-regime retention and drawdown behavior.</li>
          <li><strong>Accept:</strong> some drift-fit penalty when retention is non-negotiable.</li>
          <li><strong>Promote:</strong> only if gains survive explicit risk gates.</li>
        </ul>
      </section>

      <section id="demo" class="card" aria-label="Live evaluation">
        <div class="section-head">
          <h2>Run The Decision Test</h2>
          <p>Three methods, shared data path, deployment-oriented gates.</p>
        </div>

        <div class="control-stack">
          <div class="preset-row">
            <button id="apply-quick" class="btn btn-ghost" type="button">Quick</button>
            <button id="apply-proposal" class="btn btn-ghost" type="button">Default</button>
            <button id="apply-stress" class="btn btn-ghost" type="button">Stress+</button>
          </div>

          <form id="config-form" class="knob-grid">
            <label>Update steps<input name="steps" type="number" step="1" /></label>
            <label>Anchor weight<input name="anchorBeta" type="number" step="0.01" /></label>
            <label>Stress frequency<input name="pStress" type="number" step="0.01" /></label>
            <label>LoRA rank<input name="loraRank" type="number" step="1" /></label>
            <label>Seed<input name="seed" type="number" step="1" /></label>
          </form>

          <div class="action-row">
            <button id="run-demo" class="btn btn-primary" type="button">Run</button>
            <button id="reset-form" class="btn btn-ghost" type="button">Reset</button>
            <button id="export-run" class="btn btn-ghost" type="button">Export JSON</button>
          </div>
        </div>

        <div class="run-status">
          <p id="status-line">Ready.</p>
          <div class="progress-track"><div id="progress-fill"></div></div>
        </div>

        <article id="decision-card" class="decision-card"></article>

        <div id="impact-kpis" class="kpi-row"></div>

        <div class="chart-grid">
          <article>
            <h3>Impact vs Naive</h3>
            <canvas id="impact-chart" class="chart-canvas"></canvas>
          </article>
          <article>
            <h3>Equity Curves</h3>
            <canvas id="equity-chart" class="chart-canvas"></canvas>
          </article>
        </div>

        <article class="table-wrap">
          <h3>Method Scoreboard</h3>
          <table id="method-table" class="method-table"></table>
        </article>

        <article id="takeaway" class="takeaway"></article>
      </section>

      <section id="appendix" class="card" aria-label="Technical backbone">
        <details>
          <summary>Technical Backbone</summary>
          <div class="appendix-grid">
            <article>
              <h3>Update And Constraint Form</h3>
              <pre>w_t = arg min_w -μ̂_t^T w + γ w^T Σ̂_t w + λ_tc TC(w, w_{t-1})
subject to risk and drawdown constraints

v_t = arg min_v 0.5 ||v - g_new||^2
subject to &lt;v, g_anchor&gt; ≥ -ε</pre>
            </article>

            <article>
              <h3>Deployment Path</h3>
              <ol>
                <li>Train PEFT adapters with rolling drift + stress anchor data.</li>
                <li>Run naive, anchor, and projection on the same test path.</li>
                <li>Gate by stress retention, drawdown, and drift-fit penalty.</li>
                <li>Promote only if risk gates hold under stress-heavy settings.</li>
              </ol>
            </article>

            <article>
              <h3>References</h3>
              <ul id="ref-list" class="ref-list"></ul>
            </article>
          </div>
        </details>
      </section>
    </main>

    <footer class="footer">
      <p>Principle: if an element does not improve the decision, remove it.</p>
    </footer>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
