<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Constrained PEFT Proposal | Drift Adaptation Without Stress Regression</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="site-header">
      <div class="shell">
        <p class="eyebrow">Internship Proposal Artifact</p>
        <h1>Adapt to Drift Without Breaking Stress Behavior</h1>
        <p class="subtitle">
          One message: constrain PEFT updates with stress anchors so adaptation remains useful under regime
          change. Run the demo below and decide if it is pilot-worthy.
        </p>

        <div class="hero-actions">
          <button id="hero-run" class="btn-primary">Run Demo</button>
          <a class="btn-ghost" href="#appendix">Open Technical Appendix</a>
        </div>

        <ul class="quick-points">
          <li>What this is: constrained continual update rule for signal models.</li>
          <li>Why it matters: prevents silent stress-regime regressions.</li>
          <li>What to do next: run, compare methods, check decision card.</li>
        </ul>
      </div>
    </header>

    <main class="shell">
      <section id="demo" class="panel">
        <div class="section-head">
          <h2>Run the Mechanism (60 Seconds)</h2>
          <p>Start with a preset. Change one knob. Re-run.</p>
        </div>

        <div class="layout">
          <aside class="controls-card">
            <h3>Controls</h3>

            <div class="preset-row">
              <button id="apply-quick" class="btn-ghost">Quick</button>
              <button id="apply-proposal" class="btn-ghost">Proposal</button>
              <button id="apply-stress" class="btn-ghost">Stress</button>
            </div>

            <form id="config-form">
              <fieldset>
                <legend>Main Knobs</legend>
                <label>Update steps <input name="steps" type="number" step="1" /></label>
                <label>Anchor weight <input name="anchorBeta" type="number" step="0.01" /></label>
                <label>Stress frequency <input name="pStress" type="number" step="0.01" /></label>
                <label>LoRA rank <input name="loraRank" type="number" step="1" /></label>
              </fieldset>

              <details>
                <summary>Advanced Knobs</summary>
                <fieldset>
                  <label>Seed <input name="seed" type="number" step="1" /></label>
                  <label>Learning rate <input name="lr" type="number" step="0.001" /></label>
                  <label>Train drift samples <input name="nTrainDrift" type="number" step="1" /></label>
                  <label>Anchor stress samples <input name="nAnchorStress" type="number" step="1" /></label>
                  <label>Test drift samples <input name="nTestDrift" type="number" step="1" /></label>
                  <label>Test stress samples <input name="nTestStress" type="number" step="1" /></label>
                  <label>Batch size <input name="batchSize" type="number" step="1" /></label>
                  <label>Anchor batch size <input name="anchorBatchSize" type="number" step="1" /></label>
                  <label>Simulation horizon <input name="simT" type="number" step="1" /></label>
                  <label>Max risky weight <input name="wMaxRisky" type="number" step="0.01" /></label>
                  <label>Turnover smoothing <input name="turnoverEta" type="number" step="0.01" /></label>
                  <label>Noise std <input name="noiseStd" type="number" step="0.01" /></label>
                  <label>Return scale <input name="returnScale" type="number" step="0.001" /></label>
                </fieldset>
              </details>
            </form>

            <div class="control-actions">
              <button id="run-demo" class="btn-primary">Run Experiment</button>
              <button id="reset-form" class="btn-ghost">Reset</button>
            </div>
          </aside>

          <section class="outputs-card">
            <div class="run-status">
              <p id="status-line">Ready.</p>
              <div class="progress-track"><div id="progress-fill"></div></div>
            </div>

            <article id="decision-card" class="decision-card"></article>

            <div class="report-actions">
              <button id="export-run" class="btn-ghost">Export Run Report</button>
            </div>

            <div id="metrics-grid" class="metrics-grid"></div>

            <div class="chart-grid">
              <article>
                <h3>Tradeoff: Drift Fit vs Stress Retention</h3>
                <canvas id="scatter-chart" class="chart-canvas"></canvas>
              </article>

              <article>
                <h3>Outcome: Equity on Shared Drift+Stress Stream</h3>
                <canvas id="equity-chart" class="chart-canvas"></canvas>
              </article>
            </div>

            <article id="takeaway" class="takeaway"></article>
          </section>
        </div>
      </section>

      <section id="appendix" class="panel">
        <div class="section-head">
          <h2>Technical Appendix</h2>
          <p>Open only what you need.</p>
        </div>

        <details>
          <summary>Math and Notation</summary>
          <div class="appendix-block">
            <pre class="equation">w_t = arg min_{w in W} -μ̂_t^T w + γ w^T Σ̂_t w + λ_tc TC(w, w_{t-1})
subject to c_k(w) ≤ 0,
           CVaR_α(w) ≤ τ_α,
           Drawdown(w) ≤ τ_dd

v_t = arg min_v 0.5 ||v - g_new||^2
subject to &lt;v, g_anchor&gt; ≥ -ε</pre>
            <p>
              <code>g_new</code> fits drift. <code>g_anchor</code> protects anchors. <code>ε</code> sets allowed
              regression budget per update.
            </p>
          </div>
        </details>

        <details>
          <summary>Deployment Path (Pilot Scope)</summary>
          <div class="appendix-block">
            <ol class="compact-list">
              <li>Run PEFT-only update job with frozen backbone.</li>
              <li>Compute drift fit, anchor regression, and risk proxy metrics.</li>
              <li>Promote only if gate thresholds pass; rollback on breach.</li>
              <li>Keep optimizer/risk engine unchanged.</li>
            </ol>
          </div>
        </details>

        <details>
          <summary>Evidence and Claim Checks</summary>
          <div class="appendix-block">
            <img src="./assets/validation_wide.png" alt="Validation figure" class="reference-figure" />
            <div id="claim-checks" class="claim-checks"></div>
          </div>
        </details>

        <details>
          <summary>References and Artifacts</summary>
          <div class="appendix-block">
            <div class="refs-grid">
              <article>
                <h3>Papers</h3>
                <ul id="paper-refs" class="refs-list"></ul>
              </article>
              <article>
                <h3>Datasets</h3>
                <ul id="dataset-refs" class="refs-list"></ul>
              </article>
              <article>
                <h3>Repositories</h3>
                <ul id="repo-refs" class="refs-list"></ul>
              </article>
            </div>

            <div class="artifact-links">
              <a href="./docs/INTERNSHIP_PROPOSAL_MEMO.md">Proposal Memo</a>
              <a href="./docs/DEPLOYMENT_PLAYBOOK.md">Deployment Playbook</a>
              <a href="./validation_experiment.py">Validation Script</a>
              <a href="./README.md">Repository Guide</a>
            </div>
          </div>
        </details>
      </section>
    </main>

    <footer class="site-footer">
      <p>Clarity rule: if it does not improve the decision, it does not belong on the page.</p>
    </footer>

    <script type="module" src="./src/main.js"></script>
  </body>
</html>
